{% block _top_nav_controls_dropdown_container_widget %}
    {% set attr = layout_attr_defaults(attr, {
        '~class': " customer-menu dropdown"
    }) %}

    <div {{ block('block_attributes') }}>
        {{ block_widget(block) }}
    </div>
{% endblock %}

{% block _top_nav_customer_dropdown_menu_widget %}
    {% set attr = layout_attr_defaults(attr, {
        '~class': " customer-menu__dropdown dropdown-menu",
        'aria-labelledby': "customer-menu-trigger",
        'role': "menu"
    }) %}

    <div {{ block('block_attributes') }}>
        {{ block_widget(block) }}
    </div>
{% endblock %}

{% block _top_nav_customer_dropdown_trigger_widget %}
    {% import '@OroFrontend/layouts/renderIcon.html.twig' as renderIcon %}
    {% set attr = layout_attr_defaults(attr, {
        '~class': " btn btn--outlined-inverse btn--text customer-menu__trigger",
        'type': 'button',
        'data-toggle': 'dropdown',
        'data-placement': "bottom-end",
        'id': 'customer-menu-trigger'
    }) %}

    <button {{ block('block_attributes') }}>
        {{ renderIcon.icon({name: 'user'}) }}
            {{ block_widget(block) }}
        {{ renderIcon.icon({name: 'chevron-down', extraClass: 'customer-menu__dropdown-icon hide-on-tablet'}) }}
    </button>
{% endblock %}

{% block _top_nav_user_name_widget%}
    <span class="hide-on-tablet">{{ text }}</span>
{% endblock %}

{% block _top_nav_customer_dropdown_sign_out_link_widget %}
    {% import '@OroFrontend/layouts/renderIcon.html.twig' as renderIcon %}
    {% set attr = layout_attr_defaults(attr, {
        '~class': ' dropdown-item dropdown-item--destructive sign-out-link',
        'href': path(route_name)
    }) %}

    <a {{ block('block_attributes') }}>
        {{ renderIcon.icon({name: 'log-out'}) }} <span>{{ text|trans }}</span>
    </a>
{% endblock %}

{% block _top_nav_customer_menu_list_widget %}
    {% set attr = layout_attr_defaults(attr, {
        '~class': ' customer-menu-list'
    }) %}

    <ul {{ block('block_attributes') }}>
        {{ block_widget(block) }}
    </ul>
{% endblock %}

{% block _top_nav_customer_menu_widget %}
    {% set requestUrl = '' %}
    {% if app.request.attributes.get('_route') %}
        {% set requestUrl = path(app.request.attributes.get('_route'), app.request.attributes.get('_route_params')) %}
    {% endif %}
    {% set found = false %}

    {% for child in item.children %}
        {% if child.displayed and child.extras.isAllowed %}
            {% set currentUrl = child.uri %}
            {% set itemCurrentClass = '' %}
            {% set linkCurrentClass = '' %}
            {% if currentUrl in requestUrl and not found %}
                {% set itemCurrentClass = 'current' %}
                {% set linkCurrentClass = 'current' %}
            {% endif %}

            <li class="customer-menu-list__item {{ itemCurrentClass }}">
                <a href="{{ child.uri }}" class="{{ ' dropdown-item text-nowrap' ~ linkCurrentClass }}">
                    {{- child.label|trans -}}
                </a>
            </li>
            {% if currentUrl in requestUrl and not found %}
                {% set found = true %}
            {% endif %}
        {% endif %}
    {% endfor %}
{% endblock %}
